---
title: "회귀선형"
layout: post
---
2.로지스틱 회귀분석
2.1 개요
2.1.1 분석 목적
비 유무 예측 주제로 R을 이용한 로지스틱 회귀분석을 실시하고, 딥러닝 교재
4장에서 사용된 인공신경망을 이용한 로지스틱 회귀분석을 python으로 실행하여
결과를 비교한다.
2.1.2 데이터 셋
해당 데이터는 날씨 특성과 강우 여부에 대한 데이터로 총 15개의 변수로
이루어져 있다. 종속 변수는 RainTomorrow이며 값은 Yes, No로 제시되었다.
Date 날짜 Windspeed 일평균 풍속
MinTemp 당일 최저 기온 Humidity 일평균 습도
MaxTemp 당일 최고 기온 Pressure 일평균 기압
Rainfall 강수량 Cloud 구름이 많은 정도
Sunshine 일조량 Temp 일평균 온도
WindGustDir 가장 강한 돌풍 방향 RainToday 당일 강수 여부
WindGustSpeed 가장 강한 돌풍 속도 RainTomorrow 익일 강수 여부
WindDir 바람 방향
2.1.3 분석 방법
로지스틱 회귀 분석의 목적은 선형 회귀분석의 목표와 동일하게 종속 변수와
독립 변수 간의 관계를 구체적인 함수로 나타내어 향후 예측에 사용하는 것이다.
15
다만 종속 변수가 범주형 데이터를 대상으로 하며 입력 데이터가 주어졌을 때
해당 데이터의 결과가 특정 분류로 나뉘기 때문에 일종의 분류 기법이라 할 수
있다.
이번 분석 또한 R과 python에서 동일한 난수로 비교 분석하기 위하여 SyncRNG
패키지를 활용하였다. R의 경우 glm() 함수를 사용하여 로지스틱 회귀 분석
모델을 생성하였으며, python의 경우 순전파와 역전파를 통해 절편과 가중치를
찾고 로지스틱 활성화 함수를 추가하여 결과 값을 1 또는 0으로 나타내는
인공신경망을 만들어 분석을 진행하였다.
2.2 R 분석
2.2.1 라이브러리 및 데이터 호출
library(car)
library(lmtest)
library(ROCR)
weather <- read.csv('C:/Rwork/weather.csv',
stringsAsFactors = F)
▶ 필요한 라이브러리 로딩 및 데이터 파일을 불러왔다.
2.2.2 데이터 전처리
data$RainToday[data$RainToday == 'No'] <- 0
data$RainToday[data$RainToday == 'Yes'] <- 1
data$RainToday <- as.numeric(data$RainToday)
data$RainTomorrow[data$RainTomorrow == 'No'] <- 0
data$RainTomorrow[data$RainTomorrow == 'Yes'] <- 1
data$RainTomorrow <- as.numeric(data$RainTomorrow)
df <- na.omit(data[, -c(1, 6, 8)])
head(df)
str(df) # 361
v <- 1:round(nrow(df))
s <- SyncRNG(seed = 42)
idx <- s$shuffle(v)[1:round(length(v)*0.7)]
train <- df[idx, ]
16
test <- df[-idx, ]
# idx 83 279 255 344 302 79
# length(idx) [1] 253
model <- glm(RainTomorrow ~ ., df, family = 'binomial')
round(vif(model))
# MinTemp MaxTemp Rainfall Sunshine
WindGustSpeed WindSpeed Humidity Pressure
Cloud Temp RainToday
# 5 60 2 4
3 2 6 2
2 68 2
▶ 명목 척도로 분류되어 있는 WindGustDir, WindDir, RainToday, RainTomorrow
중 원형의 방향성을 가지는 WindGustDir, WindDir 척도는 분석에 사용하기
용이하지 않아 제외하였으며, RainToday, RainTomorrow 척도는 각각 0, 1로
변환하였다. 또한 결측치가 확인되어 결측치를 제거하였으며, 다중 공선성을
확인하여 10을 초과하는 Temp 척도 또한 제거하였다.
Temp 척도 제거 후 다중 공선성을 재확인하여 모든 척도가 10을 넘지 않는 것을
확인하였다.
# MinTemp MaxTemp Rainfall Sunshine
WindGustSpeed indSpeed Humidity Pressure
Cloud RainToday
# 5 9 2 4
3 2 4 2
2 2
2.2.3 모델 생성
model <- glm(RainTomorrow ~ ., train, family = 'binomial')
summary(model)
# Coefficients:
# Estimate Std. Error z value Pr(>|z|)
# (Intercept) 140.740032 50.294007 2.798 0.00514 **
# MinTemp -0.115552 0.073888 -1.564 0.11785
# MaxTemp 0.168534 0.084538 1.994 0.04620 *
# Rainfall 0.001458 0.052985 0.028 0.97804
# Sunshine -0.245736 0.110372 -2.226 0.02599 *
# WindGustSpeed 0.086871 0.028121 3.089 0.00201 **
# WindSpeed -0.082508 0.038756 -2.129 0.03327 *
# Humidity 0.061417 0.023050 2.664 0.00771 **
17
# Pressure -0.146648 0.048762 -3.007 0.00263 **
# Cloud 0.165200 0.123392 1.339 0.18063
# RainToday -0.574622 0.746006 -0.770 0.44114
▶ gml() 함수에 ‘family=’binomial’ 속성을 입력하여 로지스틱 회귀 모델을
생성하였으며 절편 및 변수 별 가중치를 확인하였다. binomial은 종속 변수가
이항형일 때 지정하는 속성이다.
2.2.4 예측 및 평가
pred <- predict(model, test)
result <- ifelse(pred >= 0.5, 1, 0)
table <- table(result, test$RainTomorrow)
table
# result 0 1
# 0 92 8
# 1 2 6
a <- as.numeric(result)
length(which(a == test$RainTomorrow)) / sum(table)
# [1] 0.9166667
▶ 실습 데이터에 대한 학습 모델의 예측치가 확률 값으로 제공되기 때문에, 이를
이항형으로 변환하는 과정이 필요하다. ifelse()함수를 이용하여 예측치의
벡터변수(pred)를 입력하여 이항형의 벡터 변수를 생성하였다. 변환한 데이터로
실습 데이터와 일치하는 비율 확인 결과 0.91로 확인되었다.
2.2.5 시각화
pr <- prediction(pred, test$RainTomorrow)
prf <- performance(pr, measure = 'tpr', x.measure = 'fpr')
plot(prf)
auc <- performance(pr, measure = "auc")
auc <- auc@y.values[[1]]; auc
# [1] 0.9034954
▶ ROC(Receiver Operating Characteristic) Curve 를 이용하여 모델의 정확도를
시각화하였다. ROC curve에서 왼쪽 상단의 계단 모양의 빈 공백만큼이 분류
정확도에서 오분류 정도를 나타낸다. TPR은 민감도, FPR은 특이도를 칭한다.
18
▶ AUC(Area Under the ROC curve)란 ROC Curve의 아래 면적을 나타내는
수치로 분류 모델의 성능을 나타내는 지표로 사용된다. 특이도와 민감도를 각각
x축, y축에 나타냈다. 머신러닝에서 특이도는 이항분류가 0인 Case에 대해 1로
잘못 예측한 비율이며 민감도는 이항분류가 1인 Case에 대해 1로 잘 예측한 것을
말한다. AUC 값은 약 0.9로 확인되었다.